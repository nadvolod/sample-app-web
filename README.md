# What is this codebase?
This is the Sauce Labs Sample Application which is designed to be used from desktop web browsers

# Setup

To set up the development environment for this sample app:

1. Install [Vagrant](https://www.vagrantup.com/)
2. Install [VirtualBox](https://www.virtualbox.org/)
- On Mac, make sure that you allow the appropriate permissions during installation
3. Install [Git](https://git-scm.com/downloads). On Mac, this will mean installing XCode.
4. Clone the repo `git clone https://github.com/nadvolod/sample-app-web`
5. Run the `setup-env.sh` script in the root of the repository
5. There is no step 4, you're done!

## Direct development environment setup

You can also choose to build the application directly on your host computer rather than via Vagrant/Virtualbox, however this is discouraged due to interdependency issues which frequently crop up when running multiple NPM projects in the same development environment. The usage of Vagrant/Virtualbox is intended to prevent this issue by giving this application a pristine build environment with only its dependencies present, however the usage of Vagrant/Virtualbox is not a strict requirement for building this application.

To set up the development environment directly on your host computer:

1. Install [NodeJS 10 LTS](https://nodejs.org/en/download/)
2. Update NPM to the latest version: `sudo npm i npm@latest -g`
3. Install the application dependencies - in the root of the repository: `npm install`
4. Install [Google Chrome](https://www.google.com/chrome/) for running the end-to-end tests
5. Install [OpenJDK 8](https://adoptopenjdk.net/) for running the end-to-end tests

## Setup issues

If you encounter any issues with this build process, e.g.:

```
$ npm run build
> sample-app-web@1.0.0 build /Users/unlucky-user/sample-app-web
> webpack --mode production

sh: webpack: command not found
npm ERR! file sh
npm ERR! code ELIFECYCLE
npm ERR! errno ENOENT
npm ERR! syscall spawn
npm ERR! sample-app-web@1.0.0 build: `webpack --mode production`
npm ERR! spawn ENOENT
npm ERR! 
npm ERR! Failed at the sample-app-web@1.0.0 build script.
npm ERR! This is probably not a problem with npm. There is likely additional logging output above.

npm ERR! A complete log of this run can be found in:
npm ERR!     /Users/unlucky-user/.npm/_logs/2019-06-19T02_09_09_082Z-debug.log
$
```

You have probably hit a dependency conflict issue. To resolve this, do the following in the root of the repository:

1. `npm cache clean --force`
2. `rm -rf node_modules`
3. `npm install`
4. `npm run build`

# Build

To build the application:

1. `vagrant ssh` inside the project folder
2. On the VM: `cd /usr/local/saucelabs/sample-app-web`
3. On the VM: `npm run build`
4. Again, no step 4. The build is complete!

# Run

To run the built application (which is a static website):

1. Open _[project-root]_`/dist/index.html` in a web browser
2. Click around - this is the app!


# Test

To run the application test suite (which uses Webdriver.io, Selenium, and Chrome):

1. `vagrant ssh` inside the project folder
2. On the VM: `cd /usr/local/saucelabs/sample-app-web`
3. On the VM: `npm test`

This will run the application test suite - screenshots generated by the tests will be placed in _[project-root]_`/screenshots/**/*.png`, and the output will look like:

```
"spec" Reporter:
------------------------------------------------------------------
[chrome #0-0] Spec: /usr/local/saucelabs/sample-app-web/test/e2e/specs/login.spec.js
[chrome #0-0] Running: chrome
[chrome #0-0]
[chrome #0-0] Login
[chrome #0-0]    ✓ should be able to login with the standard user
[chrome #0-0]    ✓ should be able to login with the problem user
[chrome #0-0]    ✓ should be able to login with the performance issue user
[chrome #0-0]    ✓ should not be able to login with the locked out user
[chrome #0-0]    ✓ should not be able to login without a username
[chrome #0-0]    ✓ should not be able to login without a password
[chrome #0-0]    ✓ should not be able to login with the wrong password
[chrome #0-0]
[...]

Stdout:
2019-02-13T17:38:07.822Z INFO wdio-cli:Launcher: Run onPrepare hook
Starting ChromeDriver 2.46.628388 (4a34a70827ac54148e092aafb70504c4ea7ae926) on port 9515
Only local connections are allowed.
Please protect ports used by ChromeDriver and related test frameworks to prevent access by malicious code.
2019-02-13T17:38:14.399Z INFO wdio-local-runner: Start worker 0-0 with arg: test/e2e/config/wdio.conf.js
[0-0] Saving screenshot to [./screenshots/login/standarduser-1-initial-load.png] for url: [http://localhost/]
[0-0] Saving screenshot to [./screenshots/login/standarduser-2-values-entered.png] for url: [http://localhost/]
[0-0] Saving screenshot to [./screenshots/login/standarduser-3-values-submitted.png] for url: [http://localhost/inventory.html]
[0-0] Saving screenshot to [./screenshots/login/problemuser-1-initial-load.png] for url: [http://localhost/]
[0-0] Saving screenshot to [./screenshots/login/problemuser-2-values-entered.png] for url: [http://localhost/]
[0-0] Saving screenshot to [./screenshots/login/problemuser-3-values-submitted.png] for url: [http://localhost/inventory.html]
[0-0] Saving screenshot to [./screenshots/login/perfuser-1-initial-load.png] for url: [http://localhost/]
[...]
```
